# DCT discrete consine transfrom

离散余弦变换；在第一篇文章中我们简单的学习了一下KLT（或称霍特林变换）；想要在图片压缩领域使用霍特林变换还是太奢侈了；因为霍特林变换的运算量很大；

实际上我们在JPEG标准中使用的压缩算法是**离散余弦变换**

DCT脱胎于DFT（离散傅里叶变换）；霍特林变换是最优解，但是DCT的效果接近霍特林变换；并且由于DCT脱胎于DFT，因此有类似FFT的蝶形变换可以用于硬件快速计算，因此DCT的运算量是大大小于霍特林的；



## DFT 离散傅里叶变换（简易版）

这个版本无需连续傅里叶变换的相关知识；

在介绍DCT之前我们必须先了解一下DFT；

傅里叶变换告诉我们，任何一个周期信号都可以分解成有限个正弦和余弦信号的叠加；离散傅里叶变换可以对一段有限长度的离散信号，找出它含有的各个频率的三角波分量；**即：DFT可以给出一个周期信号中，每个分量信号的 频率 幅值 相位**

但是实际上可以表述为**在长度为N的离散信号中，针对k=0，1，2，...，39，分别找出在长度N内震动k个周期的三角波分量的权值**

（为什么k不可以等于41？因为如果k=41，相当于对41个周期采40个点，严重丢失信息，**实际上信息从40个点内震动20个周期开始就已经不符合奈奎斯特抽样定理了，但是DFT的结果长度和信息长度是相同的，因此我们再例子中还是使用40个点内最多震动39个周期为例；实际上在超过20个周期之后，结果和前面0~20周期是对称的...**）



（接下来的例子中会用到三角函数的正交性，我们要先了解一下）



### 三角函数的正交性

$ C,sin(x),sin(2x),...,cos(x),cos(2x),...$被称为三角函数系，三角函数系中任何两个函数在$[-\pi,\pi]$上的积分为0，故我们称三角函数系在$[-\pi,\pi]$上正交；

$\int_{-\pi}^{\pi}sin(nx)dx=0 (n=1,2,3...)$

$\int_{-\pi}^{\pi}cos(nx)dx=0(n=1,2,3...)$

$\int_{-\pi}^{\pi}cos(nx)sin(kx)dx = 0 (n,k=1,2,3...)$

$\int_{-\pi}^{\pi}sin(nx)sin(kx) = 0(n,k=1,2,3...n\neq k)$

$\int_{-\pi}^{\pi}cos(nx)cos(kx) = 0(n,k=1,2,3...n\neq k)$

用定积分很容易就可以算出来这些，上面这些式子其实在$[0,2\pi]$上也是成立的，在任何一个长度为$2\pi$的区间内都是成立的...



### DFT：最简单的例子：

这个例子中**我们不关注采样频率，不关注时间，我们只关注点的个数**

假设我们给出一个信号$x = cos(wt)$；

1. 采样：我们假设在两个周期内对$x = cos(wt)$进行40个采样；
2. 完成采样之后原信号变成了 $x[n] = cos(2\pi\frac{2n}{40})$；
3. 选择40个**基信号**$ y_k = cos(2\pi\frac{kn}{40}) 其中k=0,1,2,3...39$这些基信号在40次采样（40个点）内，依次震动：0个周期，1个周期，2个周期....39个周期
4. 计算原始信号$x = cos(2\pi\frac{2n}{40})$与**每个**基信号之间的相关程度$\sum_{n=0}^{40-1}x*y_k$；这个相关程度记作$x[k] = \sum_{n=0}^{40-1}x*y_k$（这个东西在很多地方都能见到，它也可以表示向量的内积）
5. 如果你计算了40个基信号和原始信号之间的相关程度，你会发现只有$X_2 = \sum_{n=0}^{39}cos(2\pi \frac{2n}{40})cos(2\pi \frac{2n}{40})=20$和$X_{38}=\sum_{n=0}^{39}cos(2\pi \frac{2n}{40})cos(2\pi\frac{38n}{40})=20$，其余的n计算出来的相关程度都是0（**使用三角函数的正交性可以证明这点，不过目前我们除了点的个数不关注其他的东西，就当这个结果是我们一个一个算出来的**）
6. $n=2对应的基信号是cos(2\pi\frac{2n}{40})$，$n=38对应的基信号是cos(2\pi\frac{38}{40})$；因为$cos(2\pi\frac{38}{40}) = cos(2\pi n - 2\pi\frac{2n}{40})$；所以不难理理解为什么n=2和n=38时相关度都很高，毕竟他们两个在n取值相同的时候值是一样的；（**实际上不用考虑40个点内震动20次以上的基信号，因为根据奈奎斯特采样定理，一个周期内至少要采样两个点才能较为准确的表达一个信号...40个点内震动20次以上周期的基信号实际上失真是非常严重的...不过DFT的变换结果的长度一定**）

我们将上述的结论写成一般形式，使用$x[n]$表示原始信号，用$N$表示信号长度，有：

$X_k = \sum_{n=0}^{N-1}x[n]cos(2\pi\frac{kn}{N})其中0\le k\le N-1$

这个表达式看起来和DFT的公式有一点不一样?

DFT的表达式：$X_k = \sum_{n=0}^{N-1}x[n]e^{-2\pi j\frac{kn}{N}}$；即使是使用欧拉公式展开：$X_k = \sum_{n=0}^{N-1}x[n]cos(2\pi\frac{kn}{N})-j\sum_{n=0}^{N-1}x[n]sin(2\pi\frac{kn}{N})$；

我们得到的结果好像和DFT公式比起来，缺少了虚数部分，为什么会这样？因为在**上面的例子中，我们只使用了余弦信号去比较原始信号；这其实会带来信息上的损失，比如相位；**

请看下面，我们对原始信号做一个相位的偏移



### DFT：例子的拓展（原始信号带相位偏移）

如果原始信号有相位的偏移，例如$x_a=cos(2\pi\frac{2n}{40}+\frac{\pi}{4})$

同样使用简单的例子中的方法，使用40个基信号与原始信号对比，同样能得到n=2和n=38时的基信号最为相似；其余的n的基信号与原信号的相关系数均为0；但是不同的是，在这个例子中n=2和n=38时：$X[2] = X[38] = \sum_{n=0}^{39}cos(2\pi \frac{2n}{40} + \frac{\pi}{4})cos(2\pi \frac{2n}{40})=10\sqrt{2}$

在原始信号相移之后，这个值是20，是现在的$\sqrt{2}$倍；

现在有一个问题出现了，如果我的原始函数是$x_b=\frac{\sqrt{2}}{2}cos(2\pi\frac{2n}{40})$；我们也能得到相同的结果，那么此时我们不再能够通过$X[n]$还原出来信号，因为我们不能确定原始函数是$x_a$还是$x_b$；**此时，信息丢失了；**

这个问题的解决方法是引入另一组**正弦基信号**；计算这组基信号和原始信号之间的相关系数;

假设原始信号和某组基信号之间的相关系数分别为a和b，那么这个原始信号的表达式大约是：$acos(\frac{kn}{N})-bisin(\frac{kn}{N})$



### DFT：为什么要用复数描述信号？为什么$sin$前面要加一个$i$？

虚数的几何意义可以是将一个x轴上的数移动到y轴上，你也可以理解为将一个向量以原点为圆心旋转90°，站在向量的角度再看i，实际上会发现，实数和虚数（i）是正交的；

在使用cos和sin描述一个信号的时候，其实我们是在cos和sin正交为前提下描述信号的；复数此时就变成了一个描述信号很好用的工具；$sig=cos+isin$这中格式的复数，实际上是在表述：**sig是被 cos和sin 这一对正交的函数分解的**

与余弦的相关系数：$X_2 = \sum_{n=0}^{39}cos(2\pi \frac{2n}{40} + \frac{\pi}{4})cos(2\pi \frac{2n}{40})=10\sqrt{2}$

与负正弦的相关系数：$X_2 = \sum_{n=0}^{39}cos(2\pi \frac{2n}{40} + \frac{\pi}{4})sin(-2\pi \frac{2n}{40})=10\sqrt{2}$

![image-20230606121527751](C:\Users\lee\AppData\Roaming\Typora\typora-user-images\image-20230606121527751.png)

如这张图所示，cos和sin的系数是分布在两个轴上的；

而这种表达方式既能看到原始信息的模$\sqrt{10\sqrt{2}^2+10\sqrt{2}^2}=20$；也能看到信号的相位是$\frac{\pi}{4} $



### 带上时间再去看上面的例子

之前的例子我们没有考虑采样的频率，我们只关心采样的点数，现在让我们确定一个采样频率，从而让数据变成我们更加熟悉的样子；

假设使用$f_s = 4000Hz$的采样函数；那么在这个频率下采40个点，在这40个点中震动k次的基信号的频率就是$\frac{k*f_s}{N}$

那么$X[0],X[1],...,X[k]$上的点对应的频率是$\frac{0\times 4000}{40},\frac{1\times4000}{40},...,\frac{k\times 4000}{40}$

X[2]对应的是一个频率为200hz的基信号；

那么原始信号是不是频率为200Hz的信息？

$f_s=4000Hz$的采样信号采了40个点，总时长$\frac{1}{4000}\times40=\frac{1}{100}s$；总时长内包含两个周期，那么原始信号的周期为$T=\frac{1}{200}$；原始信号的频率确实为200Hz



### DFT：隐藏的周期性

**时域离散->频域周期**：即，如果对时域信号进行采样，然后变换，那么，得到的频域结果是有周期性的；

如果用$T_s$采样时间对函数进行采样，那么频谱将会以$f_s = \frac{1}{T_s}$为周期；所以**使用$0-f_s$和使用$f_s-2f_s$都可以得到原始的时间序列**

为什么会有这个性质？

**原因在于"得到原始的时间序列"这句话**

举个例子：

1. 对函数$sin(\frac{\pi}{2} t)$进行采样，采样时间为1s；我们取$t=0,t=1,t=2,t=3$这4个离散点；得到的离散点是$(0,0),(1,1),(2,0),(3,-1)$

2. 如果对函数$sin(\frac{5}{2}\pi t)$进行采样，采样时间为1s；同样取$t=0,t=1,t=2,t=3$这4个点；得到的离散点是$(0,0),(1,1),(2,0),(3,-1)$

虽然$sin(\frac{\pi}{2}t)和sin(\frac{5}{2}\pi t)$不是一个函数，但是使用$T_s=1$对他们采样，获得的确实**同一个离散序列**；所以实际上我们并没有办法区分使用$w=\frac{\pi}{2}和w=\frac{5}{2}\pi$逆变换出来的时间序列到底出自1或者2中的哪个函数；

（有复变函数上的解释）





## DFT离散傅里叶变换（复变函数版）

这个版本会从复变函数的角度看DFT在做什么；

### DTFT离散时间傅里叶变换	

使用一个离散的采样函数对时域进行采样，然后进行傅里叶变换，DTFT的结果在频域上是连续的，周期的；

因为采样这个行为本质上是时域乘法，时域乘法对应频域卷积，采样函数是周期函数，周期函数在频域仍旧是一个周期函数，一个周期函数和一个

### DFT离散傅里叶变换

在DTFT上的基础上对频域再进行一次采样



## 参考

https://www.zhihu.com/question/342137395

https://www.bilibili.com/video/BV1g4411a7rb/?spm_id_from=333.999.0.0&vd_source=6b8fe2a721fda958c6ea9641e14f5327

