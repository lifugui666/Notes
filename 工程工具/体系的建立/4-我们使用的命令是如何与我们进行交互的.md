# 命令是如何与用户交互的？

## linux怎么知道我们输入的是命令？





## C语言写的命令如何获取参数？

以xsel命令为例：以下为xsel的源码，我删除了其中的大部分内容，我们来看看当我们在terminal里输入`xsel -b`的时候，代码是如何处理这个命令的

```c
// xsel.c

int
main(int argc, char *argv[])
{
  //...略去
  Bool want_clipboard = False, do_delete = False;
  //...略去

#define OPT(s) (strcmp (argv[i], (s)) == 0)

  /* Expand argv array before parsing to uncombine arguments. */
  expand_argv(&argc, &argv);

  /* Parse options; modify behaviour according to user-specified options */
  for (i=1; i < argc; i++) {
    if (OPT("--help") || OPT("-h")) {
      show_help = True;
    } 
    //...略去
    else if (OPT("--clipboard") || OPT("-b")) {
      want_clipboard = True;
    } 
    //...略去
  }
  //...略去
  /* Find the "CLIPBOARD" selection if required */
  if (want_clipboard) {
    selection = XInternAtom (display, "CLIPBOARD", False);
  }
  //...略去
}

```

在这里例子中，我们主要关注一下`xsel -b`中的-b是如何被程序获取到的；

### argc和argv

首先我们需要了解，C语言中的主函数有两个参数：**argc和argv**

```c
int main(int argc, char *argv[])
{
    //.....
}
```

**argc**：参数的数量

**argv**：参数的内容

### 实践：我们直接自己写一个命令

代码：

```c
//test.c

#include "stdio.h"
#include "string.h"
int main(int argc, char *argv[])
{
    printf("argc = %d\n", argc);
    printf("argv[0] = %s\n", argv[0]);
    printf("argv[1]=  %s\n", argv[1]);
    return 0;
}
```

编译：

```shell
gcc -o mytest test.c
sudo ./mytest /usr/bin/mytest # 将二进制文件放到/usr/bin下面，这个二进制文件就变成了一个命令
```

执行

```shell
lee@lee-ThinkPad-A485:/tmp$ mytest
argc = 1
argv[0] = mytest
argv[1]=  (null)
lee@lee-ThinkPad-A485:/tmp$ mytest 1111
argc = 2
argv[0] = mytest
argv[1]=  1111
```

可以看到argc和argv的作用；相信到这里大家就可以理解C语言写出来的命令是如何识别参数的；

